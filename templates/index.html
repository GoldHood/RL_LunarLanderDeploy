<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<title>LunarLander — visor REST</title>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<style>
 body {background:#0f1420;color:#eee;font-family:system-ui,Segoe UI,Roboto,Arial}
 .bar{margin:12px}
 button{margin:4px;padding:8px 12px;border-radius:8px;border:0;background:#1e3a8a;color:#fff;cursor:pointer}
 button.stop{background:#b91c1c}
 .panel{background:#0b1020;border:1px solid #1d2a4a;border-radius:10px;padding:10px;margin:12px}
 .score{opacity:.9}
 img{width:100%;max-width:900px;border-radius:12px;background:#000}
</style>
</head>
<body>
  <div class="bar">
    <button id="btn-demo">Demo</button>
    <button data-m="Qlearning1k">Qlearning1k</button>
    <button data-m="Qlearning19k">Qlearning19k</button>
    <button data-m="Sarsa19k">Sarsa19k</button>
    <button class="stop" id="btn-stop">Stop</button>
  </div>

  <div class="panel score" id="info">Inactivo.</div>

  <div class="panel">
    <img id="cam" src="/stream.mjpeg" alt="stream"/>
  </div>

<script>
async function post(url, data){ 
  const r = await fetch(url,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(data||{})});
  return r.json();
}
document.querySelector('#btn-demo').onclick=()=>post('/demo',{}).catch(console.error);
document.querySelector('#btn-stop').onclick=()=>post('/stop',{}).catch(console.error);
document.querySelectorAll('button[data-m]').forEach(b=>{
  b.onclick=()=>post('/modelo',{nombre:b.dataset.m}).catch(console.error);
});

async function loopEstado(){
  try{
    const r = await fetch('/estado'); const j = await r.json();
    if(j.ok){
      const s = `Modo: ${j.modo || 'inactivo'}${j.modelo?(' · '+j.modelo):''} | recompensa: ${j.recompensa}`;
      document.querySelector('#info').textContent = s;
    }
  }catch(e){}
  setTimeout(loopEstado, 600);
}
loopEstado();
</script>
</body>
</html>
